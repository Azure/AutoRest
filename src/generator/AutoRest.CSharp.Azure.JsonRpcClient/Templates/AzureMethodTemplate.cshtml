@using System
@using AutoRest.CSharp.Azure.JsonRpcClient.Templates
@using System.Linq
@using AutoRest.Core.Model
@using AutoRest.Core.Utilities
@using AutoRest.CSharp.Model
@using AutoRest.CSharp.JsonRpcClient.Templates.Rest.Client
@inherits AutoRest.Core.Template<AutoRest.CSharp.Azure.Model.MethodCsa>

public System.Threading.Tasks.Task<@(Model.OperationResponseReturnTypeString)> @(Model.Name)WithHttpMessagesAsync(@(Model.GetAsyncMethodParameterDeclaration(true)))
{
    var params_ = new Microsoft.Rest.ClientRuntime.Test.Azure.AzureParam[]
    {
        @foreach(var p in Model.LocalParameters)
        {
        @:new Microsoft.Rest.ClientRuntime.Test.Azure.AzureParam("@(p.SerializedName)", @(p.Name)),
        }
    };
    var operation_ = new Microsoft.Rest.ClientRuntime.Test.Azure.AzureRequest(
        "@(Model.MethodGroup.CodeModel.Name)",
        "@(Model.SerializedName)",
        this.Client.SubscriptionId,
        params_);
    return Microsoft.Rest.ClientRuntime.Test.Azure.ServiceClientEx.Call(
        this.Client,
        operation_,
        new Microsoft.Rest.ClientRuntime.Test.Azure.Tag<@(Model.OperationResponseReturnTypeString)>());
    }
