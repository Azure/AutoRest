@using System.Linq
@using AutoRest.Core.Utilities
@using AutoRest.TypeScript.SuperAgent.Model
@inherits AutoRest.Core.Template<ClientGroupsModel>

// API version: @Model.Header.ApiVersion
// Generated by: @Model.Header.GeneratedBy at @Model.Header.GeneratedAt
// Tool version: @Model.Header.GeneratorVersion

import * as @(Model.ModelModuleName) from "./model"
import * as httpUtil from "./httpUtil"

@foreach (var client in Model.Clients)
{
@:export interface @(client.InterfaceName) {
    foreach (var method in client.Methods)
    {
@:    @(method.MethodName)(requestDto: @(method.RequestTypeName)) : @(method.ResponsePromiseTypeName);
    }
@:}

@:export class @(client.Name) extends BaseApi implements @(client.InterfaceName) {
@:
@:    public constructor(baseUrl: string) {
@:        super(baseUrl);
@:    }
    foreach (var method in client.Methods)
    {
@:    async @(method.MethodName)(requestDto: @(method.RequestTypeName)) : @(method.ResponsePromiseTypeName) {
@:        return await httpUtil.req<@($"{method.RequestTypeName}, {method.ResponseTypeName}")>(requestDto)
@:            .withUrl(`@(method.UrlTemplate)`) 
@:            .withHeaders({@(string.Join(",", method.ParamNamesInHeader.Select(p => $"'{p}' : requestDto.{p}").ToArray()))})
@:            .http@(method.HttpMethod.ToPascalCase())(@(method.ParamNamesInBody.Any() ? $"requestDto.{method.ParamNamesInBody.First()}" : ""));
@:    }
    }
@:}
}